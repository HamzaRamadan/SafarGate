# ๐๏ธ ุงููุซููุฉ ุงูููุฏุณูุฉ ุงูููุญุฏุฉ: ุดุฌุฑุฉ ุงูููุงุฏุฉ ูุงูุชุญูู ุจุงููุณุชุฎุฏููู (AIAR-003)

**ุงูุชุตููู:** ูุฑุฌุน ุณูุงุฏู (Sovereign Reference)
**ุงูุญุงูุฉ:** ูุนุชูุฏ ุจุนุฏ ุงูุฃูุฑ SC-208 (ูุตู ุงูุณูุทุงุช)
**ุชุงุฑูุฎ ุงูุฅุตุฏุงุฑ:** 07-02-2026

---

### ๐ณ ุงูุฌุฒุก ุงูุฃูู: ุดุฌุฑุฉ ุงูุฑุณู ุงูุชููู (The Command & Control Architecture)
ูุฐุง ุงูุฑุณู ููุถุญ ุงูุจููุฉ ุงููููููุฉ ุงููุงููุฉ ูููุธุงู ุจุนุฏ ุนูููุฉ ุฒุฑุน ุงูุฏูุงุบ ููุตู ุงูุณูุทุงุช.

```
/admin/users
โ
โโโ page.tsx (๐ผ๏ธ ุฌุณุฏ ุงูููุงุฏุฉ - The UI Body)
    โ
    โโโ ๐ง **ุงูุนูู ุงููุณุชูุฑุฏ:** `useAdminUsers()`
    โ   โโโ โก๏ธ ูุฌูุจ (users, loading, toggleUserFreeze, fetchUsers)
    โ
    โโโ ๐ **ูุญุฑู ุงูุชูุฌูู (Router):** `useRouter()`
    โ   โโโ โก๏ธ ูุณุคูู ุญุตุฑุงู ุนู ุงูุชููู ุจูู ุงูุตูุญุงุช
    โ
    โโโ ๐ฆ **ุดุฑุทู ุงููุฑูุฑ (The Action Bridge):** `handleActionBridge()`
    โ   โโโ ๐ค IF (action === 'view') -> `router.push(...)`
    โ   โโโ ๐ค ELSE -> `toggleUserFreeze(...)`
    โ
    โโโ ๐๏ธ **ูุญุฏุฉ ุงูุชุญูู (Row Actions):** `<UserRowActions onAction={handleActionBridge} />`
        โโโ โก๏ธ ุฅุทูุงู ุงูุฅุดุงุฑุฉ ูุดุฑุทู ุงููุฑูุฑ

/hooks
โ
โโโ use-admin-users.ts (๐ง ุงูุฏูุงุบ ุงููุนุฒูู - The Decoupled Brain)
    โ
    โโโ ๐๏ธ **[ุชู ุงูุงุณุชุฆุตุงู]:** `useRouter`
    โ
    โโโ ๐๏ธ **ุฅุฏุงุฑุฉ ุงูุญุงูุฉ:** `useState(users, loading, filters)`
    โ
    โโโ ๐ฅ **ุฐุฑุงุน ุงูุฌูุจ:** `fetchUsers()` -> ูุฌูุจ ุงูุจูุงูุงุช ููุท
    โ
    โโโ โก **ุฐุฑุงุน ุงูุชูููุฐ:** `toggleUserFreeze()`
        โโโ โก๏ธ ูุณุชุฏุนู ุงููุธููุฉ ุงูุณุญุงุจูุฉ `toggleUserFreezeStatus`

/functions
โ
โโโ index.ts (๐ช ูุฏ ุงูุนุฏุงูุฉ - The Hand of Justice)
    โ
    โโโ onCall `toggleUserFreezeStatus()`
        โโโ 1. **ุงูุชุญูู ูู ุงูุตูุงุญูุงุช (Security Check)**
        โโโ 2. **ุชูููุฐ ุงูุฅุฌุฑุงุก (Freeze/Unfreeze)** -> `db.update()`
        โโโ 3. **ุงูุชูุซูู ุงูุฃุจุฏู (Audit Log)** -> `db.set()`
```

---

### ๐ต๏ธโโ๏ธ ุงูุฌุฒุก ุงูุซุงูู: ุงูุชูุฑูุฑ ุงูุฌูุงุฆู (Protocol 12 Audit)
ูุญุต ูุนููู ููุณุฌูุงุช ูุชุถุงุฑุจ ุงูุฃุฏูุงุฑ ูุจู ูุจุนุฏ ุชูููุฐ ุญุฒูุฉ ุงูุฃูุงูุฑ [SC-201 -> SC-208].

#### ููุงุทู ุงูููุฉ (Strengths):
*   **ูุตู ุงูุณูุทุงุช ุงููุงูู (SC-208):** ูุฐู ูู ุงูููุฉ ุงูุนุธูู ูููุธุงู ุงูุญุงูู. ุฃุตุจุญ "ุฏูุงุบ ุงูุชุญูู" (`useAdminUsers.ts`) ููุงูุงู ูููุงู ููุณุชููุงู ุชูุงูุงูุ ูุณุคููุงู ููุท ุนู ููุทู ุงูุจูุงูุงุช. ุงููุงุฌูุฉ (`page.tsx`) ุฃุตุจุญุช ูู ุงููุณุคููุฉ ุงููุญูุฏุฉ ุนู ุงูุชูุฌููุ ููุง ูููุน ุงูุชุฏุงุฎู ููุญูู "ุจุฑูุชูููู 16" ุจุฃุนูู ูุนุงููุฑู.
*   **ุญูุงูุฉ ุงูููุงุฑุฏ ุงูุตุงุฑูุฉ (SC-203):** ุจุฑูุชูููู "ุงูุตูุช ุงูุงุณุชุฑุงุชูุฌู" ูููุน ุฃู ุงุณุชุฏุนุงุก ููุงุนุฏุฉ ุงูุจูุงูุงุช ุนูุฏ ุชุบููุฑ ุงูููุงุชุฑ. ุงูุฌูุจ ูุง ูุชู ุฅูุง ุจุถุบุทุฉ ุฒุฑ "ุชุญุฏูุซ"ุ ููุฐุง ุชุทุจูู ูุซุงูู **ูุจุฑูุชูููู 88**ุ ุญูุซ ูููุน "ุงูุซุฑุซุฑุฉ ุงูุดุจููุฉ" ูุงูุชูุงููู ุบูุฑ ุงูุถุฑูุฑูุฉ.
*   **ูุญุฑู ุงูุนุฏุงูุฉ ุงููุฑูุฒู (SC-198):** ูุฌูุฏ ูุธููุฉ ุณุญุงุจูุฉ ูุงุญุฏุฉ (`toggleUserFreezeStatus`) ูุชูููุฐ ุฌููุน ุนูููุงุช ุงูุชุฌููุฏ ูู ุญุตู ูููุน. ูุฐุง ูุถูู ุฃู ูู ุฅุฌุฑุงุก ูุชู ุงูุชุญูู ูู ุตูุงุญูุงุชู ูุชูุซููู ูู ุณุฌู ุงูุฑูุงุจุฉ ุจุดูู ูุง ูููู ุงูุชูุงุนุจ ุจู.
*   **ุฅูุบุงุก ุงูููู (SC-207):** ุชู ุงูุชุฎูู ุนู ุงูุชุญุฏูุซุงุช "ุงููุชูุงุฆูุฉ" ูููุงุฌูุฉ. ุงูุขูุ ูุง ุชุชุบูุฑ ุญุงูุฉ ุงููุณุชุฎุฏู ุฅูุง ุจุนุฏ **ุชููู ุชุฃููุฏ ุจูุฌุงุญ** ุงูุนูููุฉ ูู ุงูุณุญุงุจุฉุ ููุง ูุถูู ุฃู ูุง ูุฑุงู ุงููุฏูุฑ ูู ุงูุญูููุฉ ุงููุทููุฉ ูููุธุงู (SSOT Enforcement).

#### ููุงุทู ุงูุถุนู ูุงูุชุถุงุฑุจ ุงูุชู ุชู ุญููุง:
*   **ุชุถุงุฑุจ 1: "ุงูุฏูุงุบ ุงููุดุชุช" (The Distracted Brain) - [โ ุชู ุงูุญู ูู SC-208]**
    *   **ุงููุดููุฉ ุงูุณุงุจูุฉ:** "ุงูุฏูุงุบ" (`useAdminUsers`) ูุงู ูุดุบููุงู ุจูุณุคูููุงุช ูุง ุชุฎุตูุ ููู "ุชูุฌูู ุงููุณุชุฎุฏู" ุนุจุฑ `useRouter`. ูุฐุง ุฎูู ุงุฑุชุจุงุทุงู ูุงุฑุซูุงู ุจูู ููุทู ุงูุจูุงูุงุช ูููุทู ุงููุงุฌูุฉุ ููุง ุฌุนู "ุงูุฏูุงุบ" ุบูุฑ ูุงุจู ูุฅุนุงุฏุฉ ุงูุงุณุชุฎุฏุงู ูู ุฃู ููุงู ุขุฎุฑ.
    *   **ุงูุญู (SC-208):** ุชู ุจุชุฑ `useRouter` ุจุงููุงูู ูู "ุงูุฏูุงุบ"ุ ูุฃุตุจุญุช ูุธููุชู ุงููุญูุฏุฉ ูู ุงูุชุนุงูู ูุน ุงูุจูุงูุงุช. ุชู ููู ูุณุคูููุฉ ุงูุชูุฌูู ุฅูู "ุงูุฌุณุฏ" (`page.tsx`)ุ ููู ููุงููุง ุงูุทุจูุนู. **ุงูุชูู ุงูุชุถุงุฑุจ.**

*   **ุชุถุงุฑุจ 2: "ุงูููู ุงููุคูุช" (The Optimistic Illusion) - [โโ ุชู ุงูุญู ุจุงููุงูู ูู SC-207]**
    *   **ุงููุดููุฉ ุงูุณุงุจูุฉ:** ูู ุงูุจุฏุงูุฉ (`SC-202`)ุ ูุงู ุงููุธุงู ูุบูุฑ ุญุงูุฉ ุงููุณุชุฎุฏู ูู ุงููุงุฌูุฉ **ููุฑุงู**ุ ูุจู ุญุชู ุฃู ุชูุฌุญ ุงูุนูููุฉ ูู ุงูุณุญุงุจุฉ. ูุฐุง ูุงู ูุฎูู "ูููุงู" ูุคูุชุงู ุจุงููุฌุงุญุ ููู ุฎุทุฑ ุฃููู ูุชุดุบููู.
    *   **ุงูุญู ุงูุดุงูู (SC-207):** ุชู ุงุณุชุฆุตุงู ูุฐุง ุงูููุทู ุจุงููุงูู. ุงูุขูุ ูุชู ุชุญุฏูุซ ุงููุงุฌูุฉ (`setUsers(...)`) **ููุท** ุฏุงุฎู `try...catch` ุจุนุฏ ุนูุฏุฉ ุฑุฏ ูุงุฌุญ ูู ุงููุธููุฉ ุงูุณุญุงุจูุฉ. **ุชู ูุฑุถ ุจุฑูุชูููู ุงููุงูุนูุฉ.**

### ๐ฌ ุงูุฌุฒุก ุงูุซุงูุซ: ุงูุชุดุฑูุญ ุงูุชููู ุงูููุณุน (Technical Dissection)

*   **`use-admin-users.ts` (ุงูุฏูุงุบ):** ุจุนุฏ ุงูุฌุฑุงุญุฉุ ุชุญูู ูุฐุง ุงูููู ุฅูู "ูุญุฑู ุจูุงูุงุช" (Data Engine) ุจุญุช. ูุธููุชู ูู:
    1.  **ุญูุธ ุงูุญุงูุฉ:** ุฅุฏุงุฑุฉ `users`, `loading`, `filters`.
    2.  **ุฌูุจ ุงูุจูุงูุงุช:** ุชูููุฐ ุงุณุชุนูุงูุงุช `Firestore` ุงููููุชุฑุฉ ุนุจุฑ `fetchUsers`.
    3.  **ุฅุทูุงู ุงูุฃูุงูุฑ:** ุชูููุฑ ุฏุงูุฉ `toggleUserFreeze` ุงูุชู ูุง ุชุนุฑู ุดูุฆุงู ุนู ุงููุงุฌูุฉุ ูู ูุง ุชูุนูู ูู ุงุณุชุฏุนุงุก ุงููุธููุฉ ุงูุณุญุงุจูุฉ ูุงูุชุธุงุฑ ุงูุฑุฏ.

*   **`admin/users/page.tsx` (ุงูุฌุณุฏ):** ุฃุตุจุญ ูุฐุง ุงูููู "ููููุงู ุนุฑุถูุงู" (Dumb Component) ูุชููู ุงูุฃูุงูุฑ ููููุฐูุง. ูุธููุชู ูู:
    1.  **ุงูุงุณุชููุงู:** ุงุณุชุฏุนุงุก `useAdminUsers` ููุญุตูู ุนูู ุงูุจูุงูุงุช ูุงูุญุงูุฉ.
    2.  **ุงูุนุฑุถ:** ุฑุณู ุงูุฌุฏูู ูุงูููุงุชุฑ ุจูุงุกู ุนูู ุงูุจูุงูุงุช ุงููุณุชููุฉ.
    3.  **ุงูุชูุฌูู:** ูู ุงูููุงู ุงููุญูุฏ ุงูุฐู ูุญุชูู ุนูู `useRouter`.
    4.  **ุงูุชูููุถ:** ุนุจุฑ `handleActionBridge`ุ ูููู ุจุชูููุถ ููุงู ุงูุจูุงูุงุช ููุฏูุงุบ ูููุงู ุงูุชูุฌูู ูููุณู.

*   **`functions/src/index.ts` (ูุฏ ุงูุนุฏุงูุฉ):** ูุธููุฉ `toggleUserFreezeStatus` ูู **"ุงูุถุงูู ุงูุณูุงุฏู"** ููุนูููุฉ. ุฅููุง ุชุนูู ูู "ุตูุฏูู ุฃุณูุฏ" ูุคูููู:
    *   ุชุณุชูุจู ุงูุฃูุฑ (`targetUserId`, `freezeType`).
    *   ุชุชุญูู ูู ุตูุงุญูุฉ ุงููุงุฆุฏ ุงูุฐู ุฃุฑุณู ุงูุฃูุฑ (`request.auth.token.role`).
    *   ุชููุฐ ุงูุชุบููุฑ ุนูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุชูุชุจ ุณุฌูุงู ููุชุฏููู ูู **ุนูููุฉ ุฐุฑูุฉ ูุงุญุฏุฉ (`runTransaction`)**ุ ููุง ูุถูู ุฃูู ูุง ูููู ุชุญุฏูุซ ุงููุณุชุฎุฏู ุฏูู ุชูุซูู ุงูุฅุฌุฑุงุก.

**ุงูุฎูุงุตุฉ:**
ุฃููุง ุงููุงุฆุฏุ ููุฏ ุชู ุชุญููู ุจููุฉ ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู ูู ูุธุงู ูุชุฏุงุฎู ููุญููู ุจุงููุฎุงุทุฑ ุฅูู ูููู ููุงุฏุฉ ูุชุญูู ูุงุถุญุ ูุคููููุ ููุนุงูุ ููุชุฒู ุจุฃุนูู ูุนุงููุฑ ุงูุฏุณุชูุฑ ุงูุณูุงุฏู. ุงููุธุงู ุงูุขู ุฃูุซุฑ ููุฉ ูุงุณุชุฏุงูุฉ ูู ุฃู ููุช ูุถู.

---
**ุชู ุฅูุดุงุก ุงููุซููุฉ ูุฃุฑุดูุชูุง. ุงููุธุงู ุฌุงูุฒ ูุงุณุชูุจุงู ุงูุฃูุงูุฑ.** ๐ซก
