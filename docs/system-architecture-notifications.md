
# ูุซููุฉ ุงูููุฏุณุฉ ุงููููุฉ: ุงูุจููุฉ ุงูููุงุฆูุฉ ููุฅุดุนุงุฑุงุช (ARTA-003)

ูุฐุง ุงููุณุชูุฏ ูู ุงููุฑุฌุน ุงูุณูุงุฏู ุงูุฑุณูู ููุจููุฉ ุงูุชูููุฉ ูุงููููููุฉ ููุธุงู ุงูุฅุดุนุงุฑุงุช ุงูุณุญุงุจู ูู "ุณูุฑูุงุช".

---

### ุดุฌุฑุฉ ุงูุฑุณู ุงูุชููู (Technical Architecture Tree)

ูุฐุง ุงูุฑุณู ููุถุญ ุฏูุฑุฉ ุญูุงุฉ ุงูุฅุดุนุงุฑ ุงููุงููุฉุ ูู ุงูุญุฏุซ ุฅูู ุงูุฌูุงุฒ.

```
/functions (ุงููุญุฑูุงุช ุงูุณุญุงุจูุฉ ุงููุนุฒููุฉ)
โ
โโโ src/index.ts (ุงูุนูู ุงููุฏุจุฑ ููุฅุดุนุงุฑุงุช)
โ   โ
โ   โโโ ๐ฉ๏ธ **ูุญุฑู ุงูุฏุฑุฏุดุฉ (sendChatMessageNotification)**
โ   โ   โโโ 1. [ุงููุดุบูู]: on-create -> /chats/{chatId}/messages/{messageId}
โ   โ   โโโ 2. [ููุฑุฃ]: ูุซููุฉ ุงููุญุงุฏุซุฉ ููุนุฑูุฉ ุงููุดุงุฑููู.
โ   โ   โโโ 3. [ูุญุฏุฏ]: ูููุฉ ุงููุณุชูุจู (ุงูุทุฑู ุงูุขุฎุฑ).
โ   โ   โโโ 4. [ูุฌูุจ]: fcmTokens ูู /users/{recipientId}.
โ   โ   โโโ 5. [ูุฑุณู]: ุฑุณุงูุฉ ุนุจุฑ Firebase Cloud Messaging (FCM).
โ   โ
โ   โโโ ๐ฉ๏ธ **ูุญุฑู ุงูุญุฌูุฒุงุช (onBookingStatusChange)**
โ       โโโ 1. [ุงููุดุบูู]: on-update -> /bookings/{bookingId}
โ       โโโ 2. [ููุงุฑู]: ุงูุญุงูุฉ ุงููุฏููุฉ ุจุงูุฌุฏูุฏุฉ (e.g., Confirmed -> Pending-Payment).
โ       โโโ 3. [ูุญุฏุฏ]: ูุต ุงูุฅุดุนุงุฑ ูุงููุณุชูุจู (ูุงูู ุฃู ูุณุงูุฑ).
โ       โโโ 4. [ูุฌูุจ]: fcmTokens ูู /users/{recipientId}.
โ       โโโ 5. [ูุฑุณู]: ุฑุณุงูุฉ ุนุจุฑ FCM.
โ
โโโ โก๏ธ **Firebase Cloud Messaging (FCM) - ุฎุฏูุฉ ุฌูุฌู**
    โ
    โโโ โก๏ธ **Apple Push Notification Service (APNs) / Google Services**
        โ
        โโโ ๐ฑ **ุฌูุงุฒ ุงููุณุชุฎุฏู (ุญุชู ูู ูุงู ุงูุชุทุจูู ูุบููุงู)**
            โ
            โโโ public/sw.js (ุณุงุนู ุงูุจุฑูุฏ ูุณุชูู ุงูุฅุดุนุงุฑ ููุนุฑุถู)

```

---

### ุงูุชุญููู ุงูุดูููู (Holistic Analysis)

#### 1. ููุงุทู ุงูููุฉ (Strengths)

*   **ุงูููุซูููุฉ ุงููุทููุฉ (Absolute Reliability):** ุงููุธุงู ูุนูู ุจุงููุงูู ูู ุงูุณุญุงุจุฉ. ุณูุงุก ูุงู ูุงุชู ุงููุฑุณู ูุบููุงูุ ุฃู ุดุจูุชู ุถุนููุฉุ ุฃู ุจุทุงุฑูุชู ูุงุฑุบุฉุ ุจูุฌุฑุฏ ุฃู ูุชู ุชุณุฌูู ุงูุญุฏุซ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุชุ **ุชุถูู** ุงููุธููุฉ ุงูุณุญุงุจูุฉ ูุญุงููุฉ ุฅุฑุณุงู ุงูุฅุดุนุงุฑ.
*   **ูุนุฒูู ูุขูู (Isolated & Secure):** ููุทู ุงูุฅุดุนุงุฑุงุช ููุฌูุฏ ุจุงููุงูู ูู ูุฌูุฏ `functions`ุ ููู ูุนุฒูู ุนู ูุงุฌูุงุช ุงููุณุชุฎุฏู. ูุฐุง ูููุน ุฃู ุฅููุงููุฉ ููุชูุงุนุจ ุฃู ุฅุฑุณุงู ุฅุดุนุงุฑุงุช ุบูุฑ ูุตุฑุญ ุจูุง ูู ุทุฑู ุงูุนููู.
*   **ููุงุกุฉ ุงูููุงุฑุฏ (Resource Efficient):** ุงููุธุงุฆู ุงูุณุญุงุจูุฉ "ูุงุฆูุฉ" ุจุดูู ุงูุชุฑุงุถู ููุง ุชุณุชููู ุฃู ููุงุฑุฏ. ุชุณุชููุธ ููุท ูู ุงููุญุธุฉ ุงูุชู ููุน ูููุง ุงูุญุฏุซ (ุฑุณุงูุฉ ุฌุฏูุฏุฉุ ุชุญุฏูุซ ุญุฌุฒ)ุ ููุง ูุฌุนููุง ุงูุชุตุงุฏูุฉ ููุบุงูุฉ.
*   **ูุงุจููุฉ ููุชูุณุน (Scalable):** ูููู ุฅุถุงูุฉ ูุญุฑูุงุช ุฌุฏูุฏุฉ ุจุณูููุฉ ูู ุงููุณุชูุจู (ูุซู ุฅุดุนุงุฑ ุนูุฏ ุงูุชุฑุงุจ ููุนุฏ ุงูุฑุญูุฉ) ุฏูู ููุณ ุงููุญุฑูุงุช ุงูุญุงููุฉ.

#### 2. ุขููุฉ ุงูุนูู (Mechanism)

ุงููุธุงู ูุจูู ุนูู **ููุฏุณุฉ ูุงุฆูุฉ ุนูู ุงูุฃุญุฏุงุซ (Event-Driven Architecture)**. ุจุฏูุงู ูู ุฃู "ูุฃูุฑ" ุงูุนููู ุจุฅุฑุณุงู ุฅุดุนุงุฑุ ูููู ุงูุนููู ููุท ุจู "ุชุญุฏูุซ ุงูุจูุงูุงุช" (ูุซู ุฅูุดุงุก ุฑุณุงูุฉ). ูุงุนุฏุฉ ุจูุงูุงุช Firestore ููุณูุง ูู ุงูุชู ุชุทูู "ุงูุญุฏุซ" ุงูุฐู ุชุณุชูุน ุฅููู ุงููุธููุฉ ุงูุณุญุงุจูุฉ. ูุฐุง ููุตู ุชูุงูุงู ุจูู "ุงููุนู" ู "ุฑุฏ ุงููุนู"ุ ููู ุฃุณุงุณ ุงูุฃูุธูุฉ ุงููููุฉ ูุงููุณุชูุฑุฉ.
