# ูุซููุฉ ุงูููุฏุณุฉ ุงููููุฉ: ููุทู ุงูููู ุงูุฌุบุฑุงูู (SC-057)

ูุฐุง ุงููุณุชูุฏ ูู ุงููุฑุฌุน ุงูุณูุงุฏู ุงูุฑุณูู ุงูุฐู ููุซู ุขููุฉ ููุน ุชุนุฏุฏ ุงูุฑุญูุงุช ูุชุทุจูู "ุงูููู ุงูุฌุบุฑุงูู" ุงูุฅุฌุจุงุฑู ุนูู ุงููุงูู ุงููุดุท.

---

### 1. ุดุฌุฑุฉ ุงูุฑุณู ุงูุชููู (Technical Architecture Tree)

ูุฐุง ุงูุฑุณู ููุถุญ ููู ููุฑุถ ุงููุธุงู ุนูู ุงููุงูู ุงูุชุฑููุฒ ุนูู ุฑุญูุชู ุงููุดุทุฉุ ุจุฏุกุงู ูู ุชุฎุฒูู ุงููุนุฑูู ุงูุณูุงุฏู ูุงูุชูุงุกู ุจููุชุฑุฉ ุงูุณูู.

`
/ (ูุธุงู ุณูุฑูุงุช)
โ
โโโ src/lib/data.ts (๐ด ุงูููุทูุฉ ุงูุญูุฑุงุก - ููุทุฉ ุงูุชุฎุฒูู)
โ   โโโ UserProfile
โ       โโโ ๐ currentActiveTripId (ุงููุนุฑู ุงูุณูุงุฏู ููุฑุญูุฉ ุงููุดุทุฉ)
โ
โโโ src/app/carrier/layout.tsx (ุตูุงู ุงูุฃูุงู ุงูุฑุฆูุณู)
โ   โโโ handleAddTripClick()
โ       โโโ ๐ง LOGIC: if (profile.currentActiveTripId) -> BLOCK & TOAST
โ           โโโ โก๏ธ **ุงูุฃุซุฑ:** ููุน ูุชุญ ูุงูุฐุฉ "ุชุฃุณูุณ ุฑุญูุฉ" ุชูุงูุงู.
โ
โโโ src/app/carrier/opportunities/page.tsx (ุงูููุชุฑ ุงูุฅุฌุจุงุฑู ููุณูู)
    โโโ ๐ง LOGIC (useMemo):
        โโโ 1. **activeTripRef = useDoc(...)** -> ูุฑุงูุจ ุงูุฑุญูุฉ ุงููุดุทุฉ ุจุงุณุชูุฑุงุฑ.
        โ
        โโโ 2. **opportunitiesQuery**
            โโโ โ **IF (activeTrip exists):**
            โ   โโโ query(..., where('origin', '==', activeTrip.origin))
            โ   โโโ โก๏ธ **ุงูุฃุซุฑ:** ุฅุฌุจุงุฑ ุงูุณูู ุนูู ุนุฑุถ ุทูุจุงุช ูู ููุณ ูุฏููุฉ ุงูุทูุงู ุงูุฑุญูุฉ ุงููุดุทุฉ ููุท.
            โ
            โโโ โ **ELSE (activeTrip is null):**
                โโโ query(...) -> (ูุนูุฏ ููููุชุฑุฉ ุงูุนุงุฏูุฉ ุญุณุจ ุงูุงุฎุชุตุงุต).
`

---

### 2. ุงูุชุญููู ุงูุดูููู (Holistic Analysis)

#### 2.1. ุงููุฏู ุงูุงุณุชุฑุงุชูุฌู

ุงููุฏู ูู ูุฐุง ุงูููู ููุณ ุชูููุฏ ุงููุงููุ ุจู **ุญูุงูุชู ูุญูุงูุฉ ุงูุณูู**.

1.  **ููุน ุงูุชุดุชูุช:** ูุฌุจุฑ ุงููุงูู ุนูู ุงูุชุฑููุฒ ุนูู ููุก ููุงุนุฏ ุฑุญูุชู ุงูุญุงููุฉ ุจุฏูุงู ูู ูุชุญ ุฑุญูุงุช ุฌุฏูุฏุฉ ูุฏ ูุง ูุชููู ูู ุฎุฏูุชูุง.
2.  **ุฒูุงุฏุฉ ุงูููุงุกุฉ:** ูู ุฎูุงู ููุชุฑุฉ ุงูุณูู ุงูุฅุฌุจุงุฑูุฉุ ูุชู ุนุฑุถ ุงูุทูุจุงุช ุงูุฃูุซุฑ ุฃูููุฉ ูููุงูู (ุงูุชู ุชูุทูู ูู ููุณ ูุฏููุชู ุงูุญุงููุฉ)ุ ููุง ูุณุฑูุน ุนูููุฉ ููุก ุงูููุงุนุฏ ุงูุดุงุบุฑุฉ.
3.  **ููุน ุฅุบุฑุงู ุงูุณูู (Anti-Spam):** ูููุน ุงููุงูููู ูู ุฅูุดุงุก ุนุดุฑุงุช ุงูุฑุญูุงุช ุงูููููุฉุ ููุง ูุญุงูุธ ุนูู ุฌูุฏุฉ ููุตุฏุงููุฉ ุงูุนุฑูุถ ูู "ุณูู ุงูุทูุจุงุช".

#### 2.2. ุงูุงูุชุซุงู ููุจุฑูุชููููุงุช ุงูุณูุงุฏูุฉ

*   **ุจุฑูุชูููู 88 (ุญูุงูุฉ ุงูููุงุฑุฏ):**
    *   ุงุณุชุฎุฏุงู `useDoc` ูุน `useMemo` ูู ุชุทุจูู ูุซุงูู. ูุง ูุชู ุฅุฌุฑุงุก ุฃู ูุฑุงุกุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุฅุฐุง ูุงู `currentActiveTripId` ุบูุฑ ููุฌูุฏ. ูุฅุฐุง ูุงู ููุฌูุฏุงูุ ูุชู ูุฑุงุกุฉ ูุซููุฉ ูุงุญุฏุฉ ููุท ูุชุธู ูู ุงูุฐุงูุฑุฉ.

*   **ุจุฑูุชูููู 11 (ููุน ุงูุชุถุงุฑุจ):**
    *   ุงูููุทู ุงูุฌุฏูุฏ ูุชูุงูู ุจุณูุงุณุฉ ูุน ููุทู ุงูููุชุฑุฉ ุงูุณุงุจู (ุญุณุจ ุงูุงุฎุชุตุงุต)ุ ุญูุซ ูุนูู "ุงูููู ุงูุฌุบุฑุงูู" ูุทุจูุฉ ุฐุงุช ุฃููููุฉ ุฃุนูู ุชุชุฌุงูุฒ ุงูููุชุฑุฉ ุงูุนุงุฏูุฉ ุนูุฏ ูุฌูุฏ ุฑุญูุฉ ูุดุทุฉ.

*   **ุจุฑูุชูููู 14 (ุงูุฌุฑุงุญุฉ ุงูููุถุนูุฉ):**
    *   ุชู ุชูููุฐ ุงูุชุนุฏููุงุช ูู ููุงุท ูุญุฏุฏุฉ ุจุฏูุฉ ุฏูู ุงููุณุงุณ ุจุงููููู ุงูุนุงู ููููููุงุชุ ููุง ูุถูู ุณูููุฉ ุงูุตูุงูุฉ ุงููุณุชูุจููุฉ.

---

ูุฐู ุงููุซููุฉ ุชุคุฑุดู ุงููุฑุงุฑ ุงูุงุณุชุฑุงุชูุฌู ุจุชุทุจูู ุณูุงุณุฉ "ุงูุฑุญูุฉ ุงููุงุญุฏุฉ"ุ ูุชูุถุญ ููู ุชู ุชุญููู ูุฐุง ุงููุฑุงุฑ ุฅูู ููุทู ุจุฑูุฌู ุขูู ููุนุงู.
